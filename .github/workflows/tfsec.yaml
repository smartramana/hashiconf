name: tfsec
on:
  push:
    branches:
      - main
  pull_request:
jobs:
  tfsec:
    name: tfsec sarif report
    runs-on: ubuntu-latest
    permissions:
      actions: read
      contents: read
      security-events: write
    steps:
      - name: Clone repo
        uses: actions/checkout@v2
        with:
          persist-credentials: false

      - name: tfsec
        uses: suzuki-shunsuke/github-action-tfsec@v0.1.7
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          working_directory: ""
          github_comment: true # Enable github-comment notification
